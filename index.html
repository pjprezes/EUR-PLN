<body>
    <div class="card">
        <h1>ASSEMBLEX EUR (ING)</h1>
        <div id="price" class="price">...</div>
        <div id="timestamp" style="font-size: 10px; color: #28a745; margin-bottom: 15px; font-weight: bold;"></div>
        
        <button id="updateBtn" onclick="getRate()">ODŚWIEŻ KURS</button>
        <div class="footer">Korekta marży: -0.02 PLN</div>
    </div>

    <script>
        async function getRate() {
            const priceEl = document.getElementById('price');
            const timeEl = document.getElementById('timestamp');
            const btn = document.getElementById('updateBtn');
            
            // Wizualny start
            priceEl.style.opacity = "0.3";
            btn.innerText = "POBIERANIE...";
            btn.style.background = "#ddd";

            try {
                const res = await fetch('https://api.allorigins.win/get?url=' + encodeURIComponent('https://api.nbp.pl/api/exchangerates/rates/a/eur/?format=json'));
                const data = await res.json();
                const nbp = JSON.parse(data.contents).rates[0].mid;
                const final = (nbp - 0.02).toFixed(4);
                
                // Aktualizacja ceny
                priceEl.innerText = final;
                
                // Potwierdzenie czasu (Timestamp)
                const teraz = new Date();
                timeEl.innerText = "AKTUALIZACJA: " + teraz.toLocaleTimeString();
                
                // Feedback przycisku
                btn.innerText = "GOTOWE! ✔";
                btn.style.background = "#28a745";
                btn.style.color = "white";

                setTimeout(() => {
                    btn.innerText = "ODŚWIEŻ KURS";
                    btn.style.background = "#fdb913";
                    btn.style.color = "black";
                }, 1500);

            } catch (e) {
                priceEl.innerText = "BŁĄD";
                timeEl.innerText = "Sprawdź połączenie";
                btn.innerText = "PONÓW";
                btn.style.background = "#dc3545";
            } finally {
                priceEl.style.opacity = "1";
            }
        }
        getRate();
    </script>
</body>
                const final = (nbp - 0.02).toFixed(4);
                priceEl.innerText = final;
            } catch (e) {
                priceEl.innerText = "Błąd";
            } finally {
                priceEl.style.opacity = "1";
            }
        }
        getRate();
    </script>
</body>
</html>
